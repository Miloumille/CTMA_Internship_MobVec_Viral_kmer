---
output: html_document
editor_options: 
  chunk_output_type: inline
---
```{r}
fasta_files <- sprintf("barcode%02d", 33:44)

#data_dir <- normalizePath("~/Documents/University/ULB/Memoire/Memoire_CTMA/CTMA_Internship_MobVec_Viral_KMERS not_clean/data_sequencing/5")
data_dir <- normalizePath("/Volumes/Emile_Externe/perso/backup/backup/Documents/University/ULB/Memoire/Memoire_CTMA/CTMA_Internship_MobVec_Viral_KMERS/data_sequencing/4")
#db_dir <- normalizePath("~/Documents/code/databases/kraken/k2_standard_08gb_20250402")
db_dir <- normalizePath("~/Documents/code/databases/kraken/k2_eupathdb48_20230407")

############### minikraken2

for (fasta_file in fasta_files){
  file_path <- paste0("raw/",fasta_file,".fastq")
  print(paste0("processing: ",fasta_file))
  
  myarg <- paste0(
    "run --rm ",
    "-v \"", data_dir, "\":/data ",
    "-v \"", db_dir, "\":/krakendb ",
    "--cpus=4 ",
    "staphb/kraken2:2.1.3 sh -c \"",
    "kraken2 ",
    "--use-names ",
    "--threads 4 ",
    "--db /krakendb ",
    "/data/", file_path, " ",
    "--report /data/kraken2/",fasta_file,"_other.report ",
    "--output /data/kraken2/",fasta_file,"_other.output",
    "\""
  )
  
  system2(command='docker',args=myarg) 
}


pavian::runApp()
```

